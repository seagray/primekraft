<?php

use yii\db\Migration;

class m160811_124855_add_metro_coord extends Migration
{
    public function up()
    {
        $this->delete('city_objects', 'type=2');

        $q = $this->db->createCommand("SELECT id, name FROM city")->query();
        $cities = [
            'Москва' => 'msk',
            'Санкт-Петербург' => 'spb',
        ];

        foreach ($q as $r){
            $cities[$cities[$r['name']]] = $r['id'];
            unset($cities[$r['name']]);
        }

        $data = '[{"n":"Авиамоторная","la":"55.7516","lo":"37.717","c":"msk"},{"n":"Автозаводская","la":"55.7077","lo":"37.6575","c":"msk"},{"n":"Академическая","la":"55.6878","lo":"37.5734","c":"msk"},{"n":"Александровский Сад","la":"55.7523","lo":"37.6102","c":"msk"},{"n":"Алексеевская","la":"55.8078","lo":"37.6387","c":"msk"},{"n":"Алтуфьево","la":"55.8979","lo":"37.5871","c":"msk"},{"n":"Аннино","la":"55.5837","lo":"37.5968","c":"msk"},{"n":"Арбатская (ар.)","la":"55.7558","lo":"37.6176","c":"msk"},{"n":"Арбатская (фил.)","la":"55.7558","lo":"37.6176","c":"msk"},{"n":"Аэропорт","la":"55.8007","lo":"37.5322","c":"msk"},{"n":"Бабушкинская","la":"55.8699","lo":"37.6642","c":"msk"},{"n":"Багратионовская","la":"55.7438","lo":"37.4977","c":"msk"},{"n":"Баррикадная","la":"55.7608","lo":"37.5812","c":"msk"},{"n":"Бауманская","la":"55.7724","lo":"37.6788","c":"msk"},{"n":"Беговая","la":"55.7736","lo":"37.5471","c":"msk"},{"n":"Белорусская","la":"55.7769","lo":"37.5841","c":"msk"},{"n":"Беляево","la":"55.6427","lo":"37.5263","c":"msk"},{"n":"Бибирево","la":"55.8839","lo":"37.6036","c":"msk"},{"n":"Библиотека имени Ленина","la":"55.7514","lo":"37.6097","c":"msk"},{"n":"Битцевский Парк","la":"55.5992","lo":"37.5569","c":"msk"},{"n":"Боровицкая","la":"55.7523","lo":"37.6129","c":"msk"},{"n":"Ботанический Сад","la":"55.8455","lo":"37.6384","c":"msk"},{"n":"Братиславская","la":"55.6594","lo":"37.7505","c":"msk"},{"n":"Бульвар Дмитрия Донского","la":"55.5702","lo":"37.5771","c":"msk"},{"n":"Бунинская аллея","la":"55.5379","lo":"37.5154","c":"msk"},{"n":"Варшавская","la":"55.6535","lo":"37.6205","c":"msk"},{"n":"ВДНХ","la":"55.8207","lo":"37.6407","c":"msk"},{"n":"Владыкино","la":"55.8472","lo":"37.5899","c":"msk"},{"n":"Водный Стадион","la":"55.8398","lo":"37.4868","c":"msk"},{"n":"Войковская","la":"55.8188","lo":"37.498","c":"msk"},{"n":"Волгоградский Проспект","la":"55.7249","lo":"37.6871","c":"msk"},{"n":"Волжская","la":"55.6909","lo":"37.7542","c":"msk"},{"n":"Волоколамская (стр.)","la":"55.7558","lo":"37.6176","c":"msk"},{"n":"Воробьевы горы","la":"55.7103","lo":"37.5592","c":"msk"},{"n":"Выхино","la":"55.7158","lo":"37.818","c":"msk"},{"n":"Горчакова ул.","la":"55.542","lo":"37.5311","c":"msk"},{"n":"Деловой центр","la":"55.7492","lo":"37.5433","c":"msk"},{"n":"Динамо","la":"55.7897","lo":"37.5582","c":"msk"},{"n":"Дмитровская","la":"55.808","lo":"37.5811","c":"msk"},{"n":"Добрынинская","la":"55.729","lo":"37.6228","c":"msk"},{"n":"Домодедовская","la":"55.6106","lo":"37.718","c":"msk"},{"n":"Дубровка","la":"55.7178","lo":"37.6766","c":"msk"},{"n":"Измайловская","la":"55.7877","lo":"37.7816","c":"msk"},{"n":"Калужская","la":"55.6566","lo":"37.54","c":"msk"},{"n":"Кантемировская","la":"55.6358","lo":"37.6565","c":"msk"},{"n":"Каховская","la":"55.653","lo":"37.5983","c":"msk"},{"n":"Каширская","la":"55.6551","lo":"37.6487","c":"msk"},{"n":"Киевская","la":"55.7433","lo":"37.5658","c":"msk"},{"n":"Китай-Город","la":"55.7554","lo":"37.6323","c":"msk"},{"n":"Кожуховская","la":"55.7061","lo":"37.6856","c":"msk"},{"n":"Коломенская","la":"55.6779","lo":"37.6637","c":"msk"},{"n":"Комсомольская","la":"55.7754","lo":"37.656","c":"msk"},{"n":"Коньково","la":"55.6336","lo":"37.5194","c":"msk"},{"n":"Красногвардейская","la":"55.6139","lo":"37.7445","c":"msk"},{"n":"Краснопресненская","la":"55.7602","lo":"37.5773","c":"msk"},{"n":"Красносельская","la":"55.78","lo":"37.6661","c":"msk"},{"n":"Красные Ворота","la":"55.7689","lo":"37.6491","c":"msk"},{"n":"Крестьянская застава","la":"55.7323","lo":"37.6656","c":"msk"},{"n":"Кропоткинская","la":"55.7453","lo":"37.6033","c":"msk"},{"n":"Крылатское","la":"55.7568","lo":"37.4081","c":"msk"},{"n":"Кузнецкий Мост","la":"55.7615","lo":"37.6241","c":"msk"},{"n":"Кузьминки","la":"55.7054","lo":"37.7657","c":"msk"},{"n":"Кунцевская","la":"55.7307","lo":"37.4459","c":"msk"},{"n":"Курская","la":"55.7582","lo":"37.6615","c":"msk"},{"n":"Кутузовская","la":"55.74","lo":"37.5346","c":"msk"},{"n":"Ленинский Проспект","la":"55.7077","lo":"37.5862","c":"msk"},{"n":"Лубянка","la":"55.7593","lo":"37.6269","c":"msk"},{"n":"Люблино","la":"55.6763","lo":"37.7619","c":"msk"},{"n":"Марксистская","la":"55.7409","lo":"37.6564","c":"msk"},{"n":"Марьино","la":"55.6501","lo":"37.7438","c":"msk"},{"n":"Маяковская","la":"55.7699","lo":"37.596","c":"msk"},{"n":"Медведково","la":"55.8871","lo":"37.6614","c":"msk"},{"n":"Международная","la":"55.7483","lo":"37.5328","c":"msk"},{"n":"Менделеевская","la":"55.7819","lo":"37.5986","c":"msk"},{"n":"Митино (стр.)","la":"55.8729","lo":"37.4511","c":"msk"},{"n":"Молодежная","la":"55.7408","lo":"37.4168","c":"msk"},{"n":"Нагатинская","la":"55.6827","lo":"37.6218","c":"msk"},{"n":"Нагорная","la":"55.673","lo":"37.6108","c":"msk"},{"n":"Нахимовский Проспект","la":"55.6628","lo":"37.6056","c":"msk"},{"n":"Новогиреево","la":"55.7518","lo":"37.816","c":"msk"},{"n":"Новокузнецкая","la":"55.7424","lo":"37.6293","c":"msk"},{"n":"Новослободская","la":"55.7795","lo":"37.6012","c":"msk"},{"n":"Новые Черёмушки","la":"55.6703","lo":"37.5546","c":"msk"},{"n":"Октябрьская","la":"55.7303","lo":"37.6122","c":"msk"},{"n":"Октябрьское Поле","la":"55.7935","lo":"37.4934","c":"msk"},{"n":"Орехово","la":"55.6134","lo":"37.6945","c":"msk"},{"n":"Отрадное","la":"55.8633","lo":"37.6047","c":"msk"},{"n":"Охотный Ряд","la":"55.7567","lo":"37.6159","c":"msk"},{"n":"Павелецкая","la":"55.7307","lo":"37.6368","c":"msk"},{"n":"Парк Культуры","la":"55.7356","lo":"37.594","c":"msk"},{"n":"Парк Победы","la":"55.7363","lo":"37.517","c":"msk"},{"n":"Партизанская","la":"55.7884","lo":"37.7496","c":"msk"},{"n":"Первомайская","la":"55.7946","lo":"37.7993","c":"msk"},{"n":"Перово","la":"55.7511","lo":"37.7859","c":"msk"},{"n":"Петровско-Разумовская","la":"55.8364","lo":"37.5754","c":"msk"},{"n":"Печатники","la":"55.6929","lo":"37.7277","c":"msk"},{"n":"Пионерская","la":"55.736","lo":"37.467","c":"msk"},{"n":"Планерная","la":"55.8606","lo":"37.4363","c":"msk"},{"n":"Площадь Ильича","la":"55.747","lo":"37.6804","c":"msk"},{"n":"Площадь Революции","la":"55.7565","lo":"37.6217","c":"msk"},{"n":"Полежаевская","la":"55.7776","lo":"37.5189","c":"msk"},{"n":"Полянка","la":"55.7368","lo":"37.6184","c":"msk"},{"n":"Пражская","la":"55.6119","lo":"37.6038","c":"msk"},{"n":"Преображенская Площадь","la":"55.7961","lo":"37.7156","c":"msk"},{"n":"Пролетарская","la":"55.7317","lo":"37.6656","c":"msk"},{"n":"Проспект Вернадского","la":"55.6767","lo":"37.5056","c":"msk"},{"n":"Проспект Мира","la":"55.7807","lo":"37.6334","c":"msk"},{"n":"Профсоюзная","la":"55.6779","lo":"37.5628","c":"msk"},{"n":"Пушкинская","la":"55.766","lo":"37.6042","c":"msk"},{"n":"Речной Вокзал","la":"55.855","lo":"37.4761","c":"msk"},{"n":"Рижская","la":"55.7925","lo":"37.6361","c":"msk"},{"n":"Римская","la":"55.7464","lo":"37.6802","c":"msk"},{"n":"Рязанский Проспект","la":"55.7169","lo":"37.7932","c":"msk"},{"n":"Савеловская","la":"55.794","lo":"37.5892","c":"msk"},{"n":"Свиблово","la":"55.8552","lo":"37.6527","c":"msk"},{"n":"Севастопольская","la":"55.6514","lo":"37.5984","c":"msk"},{"n":"Семеновская","la":"55.7831","lo":"37.7193","c":"msk"},{"n":"Серпуховская","la":"55.7268","lo":"37.6252","c":"msk"},{"n":"Скобелевская","la":"55.5474","lo":"37.5555","c":"msk"},{"n":"Смоленская (ар.)","la":"55.7558","lo":"37.6176","c":"msk"},{"n":"Смоленская (фил.)","la":"55.7558","lo":"37.6176","c":"msk"},{"n":"Сокол","la":"55.8048","lo":"37.5155","c":"msk"},{"n":"Сокольники","la":"55.7893","lo":"37.6797","c":"msk"},{"n":"Спортивная","la":"55.7231","lo":"37.5638","c":"msk"},{"n":"Старокачаловская","la":"55.5697","lo":"37.5842","c":"msk"},{"n":"Строгино (стр.)","la":"55.8069","lo":"37.4981","c":"msk"},{"n":"Студенческая","la":"55.7389","lo":"37.5481","c":"msk"},{"n":"Сухаревская","la":"55.7723","lo":"37.6325","c":"msk"},{"n":"Сходненская","la":"55.8503","lo":"37.4399","c":"msk"},{"n":"Таганская","la":"55.7404","lo":"37.6534","c":"msk"},{"n":"Тверская","la":"55.765","lo":"37.605","c":"msk"},{"n":"Театральная","la":"55.7587","lo":"37.6177","c":"msk"},{"n":"Текстильщики","la":"55.7087","lo":"37.7307","c":"msk"},{"n":"Теплый Стан","la":"55.6189","lo":"37.507","c":"msk"},{"n":"Тимирязевская","la":"55.819","lo":"37.5755","c":"msk"},{"n":"Третьяковская","la":"55.7407","lo":"37.6256","c":"msk"},{"n":"Тульская","la":"55.7087","lo":"37.6225","c":"msk"},{"n":"Тургеневская","la":"55.766","lo":"37.6369","c":"msk"},{"n":"Тушинская","la":"55.8269","lo":"37.4374","c":"msk"},{"n":"Улица 1905 года","la":"55.7648","lo":"37.5614","c":"msk"},{"n":"Улица Академика Янгеля","la":"55.5955","lo":"37.6012","c":"msk"},{"n":"Улица Подбельского","la":"55.8145","lo":"37.734","c":"msk"},{"n":"Университет","la":"55.6926","lo":"37.5345","c":"msk"},{"n":"Ушакова Адмирала","la":"55.5453","lo":"37.5421","c":"msk"},{"n":"Филевский Парк","la":"55.7395","lo":"37.4833","c":"msk"},{"n":"Фили","la":"55.746","lo":"37.5149","c":"msk"},{"n":"Фрунзенская","la":"55.7275","lo":"37.5805","c":"msk"},{"n":"Царицыно","la":"55.6211","lo":"37.6695","c":"msk"},{"n":"Цветной Бульвар","la":"55.7717","lo":"37.6206","c":"msk"},{"n":"Черкизовская","la":"55.8038","lo":"37.7447","c":"msk"},{"n":"Чертановская","la":"55.6407","lo":"37.6058","c":"msk"},{"n":"Чеховская","la":"55.7659","lo":"37.6081","c":"msk"},{"n":"Чистые Пруды","la":"55.7649","lo":"37.6383","c":"msk"},{"n":"Чкаловская","la":"55.756","lo":"37.6587","c":"msk"},{"n":"Шаболовская","la":"55.7188","lo":"37.6079","c":"msk"},{"n":"Шоссе Энтузиастов","la":"55.7582","lo":"37.7517","c":"msk"},{"n":"Щелковская","la":"55.8096","lo":"37.7986","c":"msk"},{"n":"Щукинская","la":"55.8085","lo":"37.4643","c":"msk"},{"n":"Электрозаводская","la":"55.782","lo":"37.7052","c":"msk"},{"n":"Юго-Западная","la":"55.6637","lo":"37.4832","c":"msk"},{"n":"Южная","la":"55.6223","lo":"37.609","c":"msk"},{"n":"Ясенево","la":"55.6062","lo":"37.5333","c":"msk"},{"n":"Девяткино","la":"60.0502","lo":"30.443","c":"spb"},{"n":"Гражданский проспект","la":"60.035","lo":"30.4182","c":"spb"},{"n":"Академическая","la":"60.0128","lo":"30.396","c":"spb"},{"n":"Политехническая","la":"60.0089","lo":"30.3709","c":"spb"},{"n":"Площадь Мужества","la":"59.9998","lo":"30.3662","c":"spb"},{"n":"Лесная","la":"59.9849","lo":"30.3443","c":"spb"},{"n":"Выборгская","la":"59.9716","lo":"30.3485","c":"spb"},{"n":"Площадь Ленина","la":"59.9573","lo":"30.3554","c":"spb"},{"n":"Чернышевская","la":"59.9445","lo":"30.3599","c":"spb"},{"n":"Площадь Восстания","la":"59.9303","lo":"30.3611","c":"spb"},{"n":"Владимирская","la":"59.9276","lo":"30.3479","c":"spb"},{"n":"Пушкинская","la":"59.9207","lo":"30.3296","c":"spb"},{"n":"Балтийская","la":"59.9072","lo":"30.2996","c":"spb"},{"n":"Нарвская","la":"59.9012","lo":"30.2749","c":"spb"},{"n":"Кировский завод","la":"59.8797","lo":"30.2619","c":"spb"},{"n":"Автово","la":"59.8673","lo":"30.2613","c":"spb"},{"n":"Ленинский проспект","la":"59.8512","lo":"30.2683","c":"spb"},{"n":"Проспект Ветеранов","la":"59.8418","lo":"30.2519","c":"spb"},{"n":"Парнас","la":"60.067","lo":"30.3338","c":"spb"},{"n":"Проспект Просвещения","la":"60.0515","lo":"30.3325","c":"spb"},{"n":"Озерки","la":"60.0371","lo":"30.3215","c":"spb"},{"n":"Удельная","la":"60.0167","lo":"30.3156","c":"spb"},{"n":"Пионерская","la":"60.0025","lo":"30.2968","c":"spb"},{"n":"Чёрная речка","la":"59.9855","lo":"30.3008","c":"spb"},{"n":"Петроградская","la":"59.9664","lo":"30.3113","c":"spb"},{"n":"Горьковская","la":"59.9561","lo":"30.3189","c":"spb"},{"n":"Невский проспект","la":"59.9351","lo":"30.3297","c":"spb"},{"n":"Сенная площадь","la":"59.9271","lo":"30.3203","c":"spb"},{"n":"Технологический институт","la":"59.9165","lo":"30.3185","c":"spb"},{"n":"Фрунзенская","la":"59.9063","lo":"30.3174","c":"spb"},{"n":"Московские ворота","la":"59.8918","lo":"30.3179","c":"spb"},{"n":"Электросила","la":"59.8792","lo":"30.3187","c":"spb"},{"n":"Парк Победы","la":"59.8663","lo":"30.3218","c":"spb"},{"n":"Московская","la":"59.8513","lo":"30.3215","c":"spb"},{"n":"Звёздная","la":"59.8332","lo":"30.3494","c":"spb"},{"n":"Купчино","la":"59.8298","lo":"30.3757","c":"spb"},{"n":"Приморская","la":"59.9485","lo":"30.2345","c":"spb"},{"n":"Василеостровская","la":"59.9426","lo":"30.2783","c":"spb"},{"n":"Гостиный двор","la":"59.9339","lo":"30.3334","c":"spb"},{"n":"Маяковская","la":"59.9314","lo":"30.3546","c":"spb"},{"n":"Площадь Александра Невского-1","la":"59.923535","lo":"30.383381","c":"spb"},{"n":"Елизаровская","la":"59.8967","lo":"30.4237","c":"spb"},{"n":"Ломоносовская","la":"59.8773","lo":"30.4417","c":"spb"},{"n":"Пролетарская","la":"59.8652","lo":"30.4703","c":"spb"},{"n":"Обухово","la":"59.8487","lo":"30.4577","c":"spb"},{"n":"Рыбацкое","la":"59.831","lo":"30.5013","c":"spb"},{"n":"Спасская","la":"59.9271","lo":"30.3203","c":"spb"},{"n":"Достоевская","la":"59.9282","lo":"30.346","c":"spb"},{"n":"Лиговский проспект","la":"59.9208","lo":"30.3551","c":"spb"},{"n":"Площадь Александра Невского-2","la":"59.924360","lo":"30.386076","c":"spb"},{"n":"Новочеркасская","la":"59.9291","lo":"30.4119","c":"spb"},{"n":"Ладожская","la":"59.9324","lo":"30.4393","c":"spb"},{"n":"Проспект Большевиков","la":"59.9198","lo":"30.4668","c":"spb"},{"n":"Улица Дыбенко","la":"59.9074","lo":"30.4833","c":"spb"},{"n":"Комендантский проспект","la":"60.0086","lo":"30.2587","c":"spb"},{"n":"Старая Деревня","la":"59.9894","lo":"30.2552","c":"spb"},{"n":"Крестовский остров","la":"59.9718","lo":"30.2594","c":"spb"},{"n":"Чкаловская","la":"59.961","lo":"30.292","c":"spb"},{"n":"Спортивная","la":"59.952","lo":"30.2913","c":"spb"},{"n":"Садовая","la":"59.9267","lo":"30.3178","c":"spb"},{"n":"Звенигородская","la":"59.9207","lo":"30.3296","c":"spb"},{"n":"Волковская","la":"59.896","lo":"30.3575","c":"spb"},{"n":"Трубная","la":"55.7674","lo":"37.6221","c":"msk"}]';
        $data = json_decode($data, true);
        foreach ($data as $i) {
            $this->insert('city_objects', [
                'name' => $i['n'],
                'latitude' => $i['la'],
                'longitude' => $i['lo'],
                'city_id' => $cities[$i['c']],
                'type' => 2,
                'public' => 1
            ]);
        }
    }

    public function down()
    {
        $this->delete('city_objects', 'type=2');
    }

    /*
    // Use safeUp/safeDown to run migration code within a transaction
    public function safeUp()
    {
    }

    public function safeDown()
    {
    }
    */
}
